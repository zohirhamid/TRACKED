{% extends 'base.html' %}
{% load static %}

{% block title %}Upgrade to Pro - TRACKED{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/upgrade.css' %}">
{% endblock %}

{% block content %}
<div class="upgrade-container">
    <div class="upgrade-header">
        <h1 class="upgrade-title">Upgrade to Pro</h1>
        <p class="upgrade-subtitle">Unlock unlimited habits and advanced features</p>
    </div>
    
    <div class="billing-toggle">
        <button class="toggle-option active" data-period="monthly">Monthly</button>
        <button class="toggle-option" data-period="yearly">Yearly <span class="save-badge">Save 17%</span></button>
    </div>
    
    <div class="plan-cards">
        <!-- Free Plan -->
        <div class="plan-card">
            <div class="plan-header">
                <h2 class="plan-name">Free</h2>
                <div class="plan-price">
                    <span class="price-amount">$0</span>
                    <span class="price-period">forever</span>
                </div>
            </div>
            <ul class="plan-features">
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Up to 3 habits
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Basic tracking
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Monthly view
                </li>
            </ul>
            <div class="plan-footer">
                <span class="current-plan-badge">Current Plan</span>
            </div>
        </div>
        
        <!-- Pro Plan -->
        <div class="plan-card featured">
            <div class="featured-badge">Recommended</div>
            <div class="plan-header">
                <h2 class="plan-name">Pro</h2>
                <div class="plan-price" data-monthly data-amount="5.99" data-period="/month">
                    <span class="price-amount">$5.99</span>
                    <span class="price-period">/month</span>
                </div>
                <div class="plan-price" data-yearly data-amount="59.99" data-period="/year" style="display: none;">
                    <span class="price-amount">$59.99</span>
                    <span class="price-period">/year</span>
                </div>
            </div>
            <ul class="plan-features">
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Unlimited habits
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Advanced analytics
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Streak tracking
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Weekly summaries
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Priority support
                </li>
            </ul>
            <div class="plan-footer">
                <form action="{% url 'payments:create-checkout-session' %}" method="POST" class="checkout-form" data-monthly>
                    {% csrf_token %}
                    <input type="hidden" name="priceId" value="{{ stripe_price_monthly }}">
                    <button type="submit" class="button-primary checkout-button">Upgrade Now</button>
                </form>
                <form action="{% url 'payments:create-checkout-session' %}" method="POST" class="checkout-form" data-yearly style="display: none;">
                    {% csrf_token %}
                    <input type="hidden" name="priceId" value="{{ stripe_price_yearly }}">
                    <button type="submit" class="button-primary checkout-button">Upgrade Now</button>
                </form>
            </div>
        </div>
    </div>
    
    <p class="upgrade-note">Cancel anytime. No questions asked.</p>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggleButtons = document.querySelectorAll('.toggle-option');
    const monthlyElements = document.querySelectorAll('[data-monthly]');
    const yearlyElements = document.querySelectorAll('[data-yearly]');
    
    toggleButtons.forEach(button => {
        button.addEventListener('click', function() {
            const period = this.dataset.period;
            
            toggleButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            
            if (period === 'monthly') {
                monthlyElements.forEach(el => el.style.display = '');
                yearlyElements.forEach(el => el.style.display = 'none');
            } else {
                monthlyElements.forEach(el => el.style.display = 'none');
                yearlyElements.forEach(el => el.style.display = '');
            }
        });
    });
});
</script>
{% endblock %}